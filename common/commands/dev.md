# 虚拟团队命令定义

## 核心理念

**人类只需要表达需求，AI 自动完成全流程**

Agent 调用 = Role + Skill + Memory + Task

---

## 唯一命令：`/dev`

### 用法

```
/dev <需求描述>
```

### 支持的需求类型

| 类型 | 示例 |
|------|------|
| 新功能 | `/dev 做一个锦标赛盲注递增功能` |
| Bug 修复 | `/dev 新建档案后数据没清空` |
| 优化 | `/dev 优化排行榜查询性能` |
| 调研 | `/dev 调研 WebSocket 连接管理` |
| 技术债 | `/dev 清理 SwiftLint 警告` |

---

## AI 执行流程

### Phase 1: 理解需求

1. 分析需求类型（新功能/Bug/优化/调研/技术债）
2. 识别涉及的代码仓库
3. 确认是否有足够的上下文

### Phase 2: 变更创建

创建 `.changes/{date}_{slug}/`:

```
proposal.md   # 为什么做，影响范围
design.md     # 技术方案
tasks.md      # 实施任务
```

### Phase 3: 实施

对 tasks.md 中的每个任务：
1. TDD 实现（Red → Green → Refactor）
2. 单元测试
3. 代码审查

### Phase 4: 完成

1. 集成测试
2. 归档到 `.specs/`
3. 更新 `.roles/` 记忆

---

## 辅助命令

### `/dev:status`

查看当前变更进度

```
当前变更: 20260214_tournament-blind
进度: 3/5 任务完成
阻塞: 无
```

### `/dev:review`

请求人工代码审查（可选）

---

## 变更格式

### proposal.md

```markdown
# {功能名}

## 为什么做
[背景和动机]

## 影响范围
- 影响的 domain: auth, profile
- 风险评估: 中

## 成功标准
- [ ] 标准1
- [ ] 标准2
```

### design.md

```markdown
# 技术设计

## 核心流程
[流程描述或图]

## 数据模型
[新增/修改的数据结构]

## 错误处理
[边缘情况处理]

## 测试策略
[单元测试/集成测试计划]
```

### tasks.md

```markdown
# 实施任务

## Phase 1: 基础

- [ ] T001: 任务描述
- [ ] T002: 任务描述

## Phase 2: 核心

- [ ] T003: 任务描述
```

---

## 质量门禁

AI 自我检查清单：

- [ ] proposal.md 完整（为什么做、影响范围、成功标准）
- [ ] design.md 完整（核心流程、数据模型、错误处理、测试策略）
- [ ] tasks.md 可执行（每个任务明确可做）
- [ ] 代码有对应的测试
- [ ] 单元测试通过
- [ ] linter 通过

---

## 记忆更新

变更完成后，AI 自动：

1. **提取经验** → `.roles/lessons.md`
   ```markdown
   - [日期] {功能}: {一句话经验}
   ```

2. **记录决策** → `.roles/decisions.md`
   ```markdown
   - [日期] {功能}: {决策内容}
   ```

3. **更新偏好** → `.roles/prefs.md`
   ```markdown
   - [日期] {场景}: {偏好内容}
   ```
