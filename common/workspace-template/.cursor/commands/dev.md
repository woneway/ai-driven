---
description: AI 驱动开发唯一入口。
---

# /dev 命令 - AI 驱动开发唯一入口

## 概述

`/dev` 是唯一的开发命令。

人类只需表达需求，AI 自动完成全流程。

## 使用方式

```
人类: /dev 做一个锦标赛盲注递增功能
AI:   自动执行完整流程
```

## 执行流程（每步必须检查）

### 步骤 1: 理解需求

**输出要求**:
```
## 需求理解

### 摘要
{一句话描述}

### 目标
- 目标 1
- 目标 2

### 约束
- 约束 1
- 约束 2

### 确认
请确认以上理解正确。
```

**检查点**: 用户确认后才能继续。

---

### 步骤 2: 规范设计

**文件要求**: `.changes/{date}_{slug}/design.md`

**检查点**:
```
- [ ] design.md 存在
- [ ] 方案选型有对比（至少 2 个方案）
- [ ] API 设计清晰
- [ ] 数据模型定义
- [ ] 用户确认设计
```

**内容模板**:
```markdown
# 设计: {功能名}

## 方案选型

### 方案 A
- 优点: ...
- 缺点: ...

### 方案 B
- 优点: ...
- 缺点: ...

### 选择
选择方案 {X}，理由: ...

## API 设计
| Method | Path | 说明 |
|--------|------|------|
| GET | /api/xxx | ... |

## 数据模型
```typescript
interface Xxx { ... }
```
```

**检查点**: 用户确认设计后才能继续。

---

### 步骤 3: TDD 实现

**检查点**:
```
- [ ] 测试文件存在（{name}.test.ts）
- [ ] 测试通过（npm test）
- [ ] 覆盖率 >= 80%（npm test -- --coverage）
- [ ] lint 通过（npm run lint）
```

**流程**:
1. 先写测试（RED）
2. 写实现通过测试（GREEN）
3. 重构（REFACTOR）
4. 验证覆盖率

---

### 步骤 4: 代码审查

**使用代理**: code-reviewer

**检查点**:
```
- [ ] 审查完成
- [ ] 无 Critical 问题
- [ ] 无 Major 问题
- [ ] 修复所有问题
```

---

### 步骤 5: E2E 测试

**使用代理**: e2e-runner

**检查点**:
```
- [ ] 关键路径测试通过
- [ ] 无阻塞问题
```

---

### 步骤 6: 记忆更新

**文件要求**:
- `.roles/knowledge.md`
- `.changes/{date}_{slug}/summary.md`

**检查点**:
```
- [ ] knowledge.md 已更新
- [ ] summary.md 已创建
```

**summary.md 模板**:
```markdown
# 任务完成总结

## 任务名称
{任务名}

## 完成时间
{时间}

## 技术方案
{方案}

## 遇到的问题
{问题} → {解决方案}

## 后续注意
{改进点}
```

---

### 步骤 7: 完成报告

**输出**:
```
## 任务完成

### 完成内容
- [ ] 功能 1
- [ ] 功能 2

### 测试结果
- 单元测试: 通过
- E2E: 通过
- 覆盖率: XX%

### 记忆更新
- knowledge.md: 已更新
- summary.md: 已创建
```

---

## 失败处理

如果某步骤失败：

1. **停止当前步骤**
2. **修复问题**
3. **重新执行该步骤**
4. **通过后才能继续下一步**

---

## 重要

- 每步骤必须有明确的**检查点输出**
- 用户需要**确认**的步骤（需求理解、规范设计）必须等待确认
- 其他步骤失败则**停止并修复**
- 最后必须**记忆更新**