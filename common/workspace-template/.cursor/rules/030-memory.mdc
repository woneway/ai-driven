---
description: 记忆规则。AI 在开发过程中自动学习和记忆项目知识，实现跨会话的持续学习。
globs: "*"
---

# 记忆规则

## 核心理念

**记忆是闭环的一部分，通过 /verify 自动触发**

## 自动记忆触发

### 主要方式: /verify 自动触发

每次执行 `/verify` 并通过所有检查后，自动调用记忆服务：

```python
# /verify 自动执行
memory = AiDrivenMemory(workspace_name)
memory.add(f"任务完成: {task_name}")
```

### 次要方式: 手动调用

在特殊情况下，也可以手动调用：

```python
from common.memory.memory_client import AiDrivenMemory
memory = AiDrivenMemory(workspace_name)
memory.add("手动记忆的内容")
```

## 记忆内容结构

```markdown
## 任务: {任务名称}

### 技术方案
{使用的技术方案描述}

### 遇到的问题
{遇到的问题及解决方案}

### 后续注意
{可能的改进点}
```

## 记忆质量

### 好的记忆
- 具体明确
- 包含上下文
- 有时间戳

### 避免的记忆
- 模糊不清
- 过于笼统
- 缺少上下文

## 检索使用

在开始新任务前，AI 应先检索相关记忆：

```python
related = memory.search(f"{任务关键词}")
if related:
    print("相关记忆:")
    for r in related:
        print(f"- {r['content']}")
```

## 开发流程

```
1. /sdd 规范设计
2. /plan 需求分析
3. /tdd TDD 实现
4. /code-review 代码审查
5. /e2e E2E 测试
6. /verify 验证 + 记忆 ← 自动触发
```