---
description: /dev 命令 - AI 驱动开发入口。唯一开发命令。
globs: "*"
---
# /dev 命令

`/dev` 是唯一的开发命令。人类只需表达需求，AI 自动完成全流程。

## 用法

```
/dev <需求描述>
```

## 支持的需求类型

| 类型 | 示例 |
|------|------|
| 新功能 | `/dev 做一个锦标赛盲注递增功能` |
| Bug 修复 | `/dev 新建档案后数据没清空` |
| 优化 | `/dev 优化排行榜查询性能` |
| 调研 | `/dev 调研 WebSocket 连接管理` |
| 技术债 | `/dev 清理 SwiftLint 警告` |

## 执行流程

```
用户需求 → 分析 → 创建变更目录 → 调度子 Agent → 执行 → 验证 → 更新记忆
```

### 1. 分析需求

判断类型（新功能/Bug/优化/调研/技术债）和复杂度：
- 小：< 2 小时，单文件改动
- 中：2 小时 - 1 天，多文件改动  
- 大：> 1 天，跨模块改动

### 2. 创建变更目录

```
.changes/{date}_{slug}/
├── proposal.md    # 需求分析
├── design.md      # 技术设计
└── tasks.md       # 实施任务
```

### 3. 调度子 Agent

| Agent | 职责 |
|-------|------|
| planner | 需求分析、设计、任务拆解 |
| executor | 代码实现、TDD |
| reviewer | 代码审查 |
| researcher | 技术调研 |
| qa | 测试验证 |

### 复杂度调度

| 复杂度 | 调度 |
|--------|------|
| 小 | executor → reviewer |
| 中 | planner → executor → reviewer |
| 大 | planner → executor → reviewer → qa |

### 类型跳过规则

| 类型 | 可跳过 |
|------|--------|
| Bug 修复 | planner |
| 调研 | executor, qa |
| 小优化 | planner, qa |

### 4. 记忆更新

变更完成后更新：
- `.roles/lessons.md` - 经验教训
- `.roles/decisions.md` - 架构决策
- `.roles/prefs.md` - 代码偏好
- `.roles/feedback.md` - 反馈给 ai-driven
