---
description: /dev 命令 - AI 驱动开发入口。定义唯一开发命令和执行流程。
globs: "*"
---
# /dev 命令

`/dev` 是唯一的开发命令。人类只需表达需求，AI 自动完成全流程。

## 用法

```
/dev <需求描述>
```

## 支持的需求类型

| 类型 | 示例 |
|------|------|
| 新功能 | `/dev 做一个锦标赛盲注递增功能` |
| Bug 修复 | `/dev 新建档案后数据没清空` |
| 优化 | `/dev 优化排行榜查询性能` |
| 调研 | `/dev 调研 WebSocket 连接管理` |
| 技术债 | `/dev 清理 SwiftLint 警告` |

## 执行流程

```
用户需求
    ↓
Main Agent 分析
    ↓
根据复杂度选择调度策略
    ↓
调度子 Agent
    ↓
执行并验证
    ↓
更新记忆
```

## 子 Agent 调度

### Agent 定义

| Agent | 职责 | 说明 |
|-------|------|------|
| planner | 计划 | 需求分析、设计、任务拆解 |
| executor | 执行 | 代码实现、TDD |
| reviewer | 审查 | 代码审查 |
| researcher | 调研 | 技术调研 |
| qa | 测试 | 测试验证 |

### Task tool 调用

```python
Task(
    description="[Agent] 执行: [任务]",
    subagent_type="generalPurpose",
    prompt="""
        # Agent 定义
        [读取 .cursor/agents/[agent].md]

        # 项目上下文
        [读取 .space-config]

        # 代码仓库
        - 代码根目录: [从 CODE_ROOTS 获取]

        # 任务
        [具体任务描述]
    """
)
```

## 变更结构

```
.changes/{date}_{slug}/
├── proposal.md    # 为什么做
├── design.md      # 技术设计
└── tasks.md       # 实施任务
```

## 质量门禁

AI 自我检查：

- [ ] proposal.md 完整
- [ ] design.md 完整
- [ ] 有对应的测试
- [ ] 测试通过
- [ ] linter 通过

## 记忆更新

变更完成后自动更新：

- `.roles/lessons.md` - 经验教训
- `.roles/decisions.md` - 架构决策
- `.roles/prefs.md` - 代码偏好
- `.roles/feedback.md` - 反馈给 ai-driven
