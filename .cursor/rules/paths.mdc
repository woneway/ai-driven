---
description: 路径配置规范 — 禁止硬编码路径（ai-driven 框架开发用）
alwaysApply: true
---

# 路径配置规范

本规则确保 ai-driven 框架可以无缝开源，用户 fork 后可以直接使用。

## 禁止硬编码

以下路径禁止硬编码在代码/配置文件（.md、.json、.sh 等）中：

- 任何包含特定用户名的绝对路径（如 `/Users/xxx/`）
- 硬编码的 home 目录路径

## 正确做法

### 1. 项目级配置：使用 `.workspace.env` 文件

```bash
# 从 .workspace.env 读取
source .workspace.env && echo $PROJECT_PATH

# 或使用 grep
grep 'PROJECT_PATH' .workspace.env | cut -d'=' -f2
```

### 2. 相对路径

优先使用相对路径而非绝对路径：

```bash
# 错误
source /path/to/ai-driven/.workspace.env

# 正确
source ./.workspace.env
# 或
source "$(dirname "$0")/../.workspace.env"
```

### 3. 动态路径推导

使用脚本自身位置推导路径：

```bash
# 从脚本位置推导项目根目录
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
AI_DRIVEN_ROOT="$(cd "$SCRIPT_DIR/.." && pwd)"
```

## 新增资源检查

创建新的 commands/rules/skills 时：

1. 检查文件内容是否有硬编码路径
2. 确保使用 `.workspace.env` 或相对路径
3. 模板文件（workspace-template/ 下的）必须能复制到任意环境使用

## 常见错误模式

| 错误模式 | 修正方法 |
|---------|---------|
| 硬编码绝对路径 | 使用相对路径或从 .workspace.env 读取 |

## 例外情况

框架内部脚本（如 `common.sh`、`setup-global.sh`）在 ai-driven 根目录运行时，可以使用 `common.sh` 中的自动推导逻辑，不需要禁止硬编码。但仍建议优先使用环境变量。
